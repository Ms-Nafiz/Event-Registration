import{r as h,a as N}from"../react-CNOZSPzq.js";import{c as ue}from"../classcat-RvS1aOr8.js";import{u as Vo,c as Lo,s as se}from"../zustand-BiaLcQ9o.js";import{i as Fe,z as Oo}from"../d3-zoom-BUn_QO1H.js";import"../react-dom-DfT9qZI1.js";import{s as gn,p as Fo}from"../d3-selection-DSeOx27A.js";import{d as Zo}from"../d3-drag-CKshNLwO.js";const lt=h.createContext(null),Yo=lt.Provider,me={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},pn=me.error001();function q(e,t){const n=h.useContext(lt);if(n===null)throw new Error(pn);return Vo(n,e,t)}const ne=()=>{const e=h.useContext(lt);if(e===null)throw new Error(pn);return h.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Uo=e=>e.userSelectionActive?"none":"all";function Xo({position:e,children:t,className:n,style:o,...s}){const i=q(Uo),r=`${e}`.split("-");return N.createElement("div",{className:ue(["react-flow__panel",n,...r]),style:{...o,pointerEvents:i},...s},t)}function Wo({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:N.createElement(Xo,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},N.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Go=({x:e,y:t,label:n,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:i={},labelBgPadding:r=[2,4],labelBgBorderRadius:c=2,children:l,className:u,...a})=>{const d=h.useRef(null),[p,f]=h.useState({x:0,y:0,width:0,height:0}),S=ue(["react-flow__edge-textwrapper",u]);return h.useEffect(()=>{if(d.current){const g=d.current.getBBox();f({x:g.x,y:g.y,width:g.width,height:g.height})}},[n]),typeof n>"u"||!n?null:N.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:S,visibility:p.width?"visible":"hidden",...a},s&&N.createElement("rect",{width:p.width+2*r[0],x:-r[0],y:-r[1],height:p.height+2*r[1],className:"react-flow__edge-textbg",style:i,rx:c,ry:c}),N.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:d,style:o},n),l)};var Ko=h.memo(Go);const $t=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ue=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),It=(e={x:0,y:0},t)=>({x:Ue(e.x,t[0][0],t[1][0]),y:Ue(e.y,t[0][1],t[1][1])}),Zt=(e,t,n)=>e<t?Ue(Math.abs(e-t),1,50)/50:e>n?-Ue(Math.abs(e-n),1,50)/50:0,hn=(e,t)=>{const n=Zt(e.x,35,t.width-35)*20,o=Zt(e.y,35,t.height-35)*20;return[n,o]},mn=e=>e.getRootNode?.()||window?.document,jo=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Rt=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),qo=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Yt=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),St=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Qo=e=>ae(e.width)&&ae(e.height)&&ae(e.x)&&ae(e.y),ae=e=>!isNaN(e)&&isFinite(e),K=Symbol.for("internals"),yn=["Enter"," ","Escape"],Jo=(e,t)=>{},es=e=>"nativeEvent"in e;function wt(e){const n=(es(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n?.nodeName)||n?.hasAttribute("contenteditable")||!!n?.closest(".nokey")}const xn=e=>"clientX"in e,Se=(e,t)=>{const n=xn(e),o=n?e.clientX:e.touches?.[0].clientX,s=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:s-(t?.top??0)}},rt=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0,et=({id:e,path:t,labelX:n,labelY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:p,interactionWidth:f=20})=>N.createElement(N.Fragment,null,N.createElement("path",{id:e,style:a,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:p}),f&&N.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}),s&&ae(n)&&ae(o)?N.createElement(Ko,{x:n,y:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u}):null);et.displayName="BaseEdge";function Ke(e,t,n){return n===void 0?n:o=>{const s=t().edges.find(i=>i.id===e);s&&n(o,{...s})}}function En({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,i=n<e?n+s:n-s,r=Math.abs(o-t)/2,c=o<t?o+r:o-r;return[i,c,s,r]}function Sn({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:i,targetControlX:r,targetControlY:c}){const l=e*.125+s*.375+r*.375+n*.125,u=t*.125+i*.375+c*.375+o*.125,a=Math.abs(l-e),d=Math.abs(u-t);return[l,u,a,d]}var Re;(function(e){e.Strict="strict",e.Loose="loose"})(Re||(Re={}));var Ie;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ie||(Ie={}));var Qe;(function(e){e.Partial="partial",e.Full="full"})(Qe||(Qe={}));var Ee;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Ee||(Ee={}));var it;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(it||(it={}));var z;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(z||(z={}));function Ut({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===z.Left||e===z.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function wn({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:o,targetY:s,targetPosition:i=z.Top}){const[r,c]=Ut({pos:n,x1:e,y1:t,x2:o,y2:s}),[l,u]=Ut({pos:i,x1:o,y1:s,x2:e,y2:t}),[a,d,p,f]=Sn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:r,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${r},${c} ${l},${u} ${o},${s}`,a,d,p,f]}const Tt=h.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=z.Bottom,targetPosition:i=z.Top,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:p,markerEnd:f,markerStart:S,interactionWidth:g})=>{const[m,y,x]=wn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i});return N.createElement(et,{path:m,labelX:y,labelY:x,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:p,markerEnd:f,markerStart:S,interactionWidth:g})});Tt.displayName="SimpleBezierEdge";const Xt={[z.Left]:{x:-1,y:0},[z.Right]:{x:1,y:0},[z.Top]:{x:0,y:-1},[z.Bottom]:{x:0,y:1}},ts=({source:e,sourcePosition:t=z.Bottom,target:n})=>t===z.Left||t===z.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Wt=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function ns({source:e,sourcePosition:t=z.Bottom,target:n,targetPosition:o=z.Top,center:s,offset:i}){const r=Xt[t],c=Xt[o],l={x:e.x+r.x*i,y:e.y+r.y*i},u={x:n.x+c.x*i,y:n.y+c.y*i},a=ts({source:l,sourcePosition:t,target:u}),d=a.x!==0?"x":"y",p=a[d];let f=[],S,g;const m={x:0,y:0},y={x:0,y:0},[x,b,v,H]=En({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(r[d]*c[d]===-1){S=s.x??x,g=s.y??b;const L=[{x:S,y:l.y},{x:S,y:u.y}],k=[{x:l.x,y:g},{x:u.x,y:g}];r[d]===p?f=d==="x"?L:k:f=d==="x"?k:L}else{const L=[{x:l.x,y:u.y}],k=[{x:u.x,y:l.y}];if(d==="x"?f=r.x===p?k:L:f=r.y===p?L:k,t===o){const M=Math.abs(e[d]-n[d]);if(M<=i){const E=Math.min(i-1,i-M);r[d]===p?m[d]=(l[d]>e[d]?-1:1)*E:y[d]=(u[d]>n[d]?-1:1)*E}}if(t!==o){const M=d==="x"?"y":"x",E=r[d]===c[M],A=l[M]>u[M],V=l[M]<u[M];(r[d]===1&&(!E&&A||E&&V)||r[d]!==1&&(!E&&V||E&&A))&&(f=d==="x"?L:k)}const C={x:l.x+m.x,y:l.y+m.y},$={x:u.x+y.x,y:u.y+y.y},R=Math.max(Math.abs(C.x-f[0].x),Math.abs($.x-f[0].x)),T=Math.max(Math.abs(C.y-f[0].y),Math.abs($.y-f[0].y));R>=T?(S=(C.x+$.x)/2,g=f[0].y):(S=f[0].x,g=(C.y+$.y)/2)}return[[e,{x:l.x+m.x,y:l.y+m.y},...f,{x:u.x+y.x,y:u.y+y.y},n],S,g,v,H]}function os(e,t,n,o){const s=Math.min(Wt(e,t)/2,Wt(t,n)/2,o),{x:i,y:r}=t;if(e.x===i&&i===n.x||e.y===r&&r===n.y)return`L${i} ${r}`;if(e.y===r){const u=e.x<n.x?-1:1,a=e.y<n.y?1:-1;return`L ${i+s*u},${r}Q ${i},${r} ${i},${r+s*a}`}const c=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${r+s*l}Q ${i},${r} ${i+s*c},${r}`}function Nt({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:o,targetY:s,targetPosition:i=z.Top,borderRadius:r=5,centerX:c,centerY:l,offset:u=20}){const[a,d,p,f,S]=ns({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:i,center:{x:c,y:l},offset:u});return[a.reduce((m,y,x)=>{let b="";return x>0&&x<a.length-1?b=os(a[x-1],y,a[x+1],r):b=`${x===0?"M":"L"}${y.x} ${y.y}`,m+=b,m},""),d,p,f,S]}const dt=h.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,sourcePosition:d=z.Bottom,targetPosition:p=z.Top,markerEnd:f,markerStart:S,pathOptions:g,interactionWidth:m})=>{const[y,x,b]=Nt({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:o,targetPosition:p,borderRadius:g?.borderRadius,offset:g?.offset});return N.createElement(et,{path:y,labelX:x,labelY:b,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:f,markerStart:S,interactionWidth:m})});dt.displayName="SmoothStepEdge";const Ht=h.memo(e=>N.createElement(dt,{...e,pathOptions:h.useMemo(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));Ht.displayName="StepEdge";function ss({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,i,r,c]=En({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,i,r,c]}const Pt=h.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:p,interactionWidth:f})=>{const[S,g,m]=ss({sourceX:e,sourceY:t,targetX:n,targetY:o});return N.createElement(et,{path:S,labelX:g,labelY:m,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:p,interactionWidth:f})});Pt.displayName="StraightEdge";function tt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Gt({pos:e,x1:t,y1:n,x2:o,y2:s,c:i}){switch(e){case z.Left:return[t-tt(t-o,i),n];case z.Right:return[t+tt(o-t,i),n];case z.Top:return[t,n-tt(n-s,i)];case z.Bottom:return[t,n+tt(s-n,i)]}}function Nn({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:o,targetY:s,targetPosition:i=z.Top,curvature:r=.25}){const[c,l]=Gt({pos:n,x1:e,y1:t,x2:o,y2:s,c:r}),[u,a]=Gt({pos:i,x1:o,y1:s,x2:e,y2:t,c:r}),[d,p,f,S]=Sn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:c,sourceControlY:l,targetControlX:u,targetControlY:a});return[`M${e},${t} C${c},${l} ${u},${a} ${o},${s}`,d,p,f,S]}const ct=h.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=z.Bottom,targetPosition:i=z.Top,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:p,markerEnd:f,markerStart:S,pathOptions:g,interactionWidth:m})=>{const[y,x,b]=Nn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i,curvature:g?.curvature});return N.createElement(et,{path:y,labelX:x,labelY:b,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:p,markerEnd:f,markerStart:S,interactionWidth:m})});ct.displayName="BezierEdge";const Dt=h.createContext(null),rs=Dt.Provider;Dt.Consumer;const is=()=>h.useContext(Dt),cs=e=>"id"in e&&"source"in e&&"target"in e,as=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${n}${o||""}`,bt=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,ls=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),ds=(e,t)=>{if(!e.source||!e.target)return t;let n;return cs(e)?n={...e}:n={...e,id:as(e)},ls(n,t)?t:t.concat(n)},Ct=({x:e,y:t},[n,o,s],i,[r,c])=>{const l={x:(e-n)/s,y:(t-o)/s};return i?{x:r*Math.round(l.x/r),y:c*Math.round(l.y/c)}:l},bn=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o}),Ze=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],o=(e.height??0)*t[1],s={x:e.position.x-n,y:e.position.y-o};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-o}:s}},kt=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const{x:i,y:r}=Ze(s,t).positionAbsolute;return jo(o,Rt({x:i,y:r,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return qo(n)},Cn=(e,t,[n,o,s]=[0,0,1],i=!1,r=!1,c=[0,0])=>{const l={x:(t.x-n)/s,y:(t.y-o)/s,width:t.width/s,height:t.height/s},u=[];return e.forEach(a=>{const{width:d,height:p,selectable:f=!0,hidden:S=!1}=a;if(r&&!f||S)return!1;const{positionAbsolute:g}=Ze(a,c),m={x:g.x,y:g.y,width:d||0,height:p||0},y=St(l,m),x=typeof d>"u"||typeof p>"u"||d===null||p===null,b=i&&y>0,v=(d||0)*(p||0);(x||b||y>=v||a.dragging)&&u.push(a)}),u},vn=(e,t)=>{const n=e.map(o=>o.id);return t.filter(o=>n.includes(o.source)||n.includes(o.target))},Mn=(e,t,n,o,s,i=.1)=>{const r=t/(e.width*(1+i)),c=n/(e.height*(1+i)),l=Math.min(r,c),u=Ue(l,o,s),a=e.x+e.width/2,d=e.y+e.height/2,p=t/2-a*u,f=n/2-d*u;return{x:p,y:f,zoom:u}},$e=(e,t=0)=>e.transition().duration(t);function Kt(e,t,n,o){return(t[n]||[]).reduce((s,i)=>(`${e.id}-${i.id}-${n}`!==o&&s.push({id:i.id||null,type:n,nodeId:e.id,x:(e.positionAbsolute?.x??0)+i.x+i.width/2,y:(e.positionAbsolute?.y??0)+i.y+i.height/2}),s),[])}function us(e,t,n,o,s,i){const{x:r,y:c}=Se(e),u=t.elementsFromPoint(r,c).find(S=>S.classList.contains("react-flow__handle"));if(u){const S=u.getAttribute("data-nodeid");if(S){const g=_t(void 0,u),m=u.getAttribute("data-handleid"),y=i({nodeId:S,id:m,type:g});if(y){const x=s.find(b=>b.nodeId===S&&b.type===g&&b.id===m);return{handle:{id:m,type:g,nodeId:S,x:x?.x||n.x,y:x?.y||n.y},validHandleResult:y}}}}let a=[],d=1/0;if(s.forEach(S=>{const g=Math.sqrt((S.x-n.x)**2+(S.y-n.y)**2);if(g<=o){const m=i(S);g<=d&&(g<d?a=[{handle:S,validHandleResult:m}]:g===d&&a.push({handle:S,validHandleResult:m}),d=g)}}),!a.length)return{handle:null,validHandleResult:An()};if(a.length===1)return a[0];const p=a.some(({validHandleResult:S})=>S.isValid),f=a.some(({handle:S})=>S.type==="target");return a.find(({handle:S,validHandleResult:g})=>f?S.type==="target":p?g.isValid:!0)||a[0]}const fs={source:null,target:null,sourceHandle:null,targetHandle:null},An=()=>({handleDomNode:null,isValid:!1,connection:fs,endHandle:null});function $n(e,t,n,o,s,i,r){const c=s==="target",l=r.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),u={...An(),handleDomNode:l};if(l){const a=_t(void 0,l),d=l.getAttribute("data-nodeid"),p=l.getAttribute("data-handleid"),f=l.classList.contains("connectable"),S=l.classList.contains("connectableend"),g={source:c?d:n,sourceHandle:c?p:o,target:c?n:d,targetHandle:c?o:p};u.connection=g,f&&S&&(t===Re.Strict?c&&a==="source"||!c&&a==="target":d!==n||p!==o)&&(u.endHandle={nodeId:d,handleId:p,type:a},u.isValid=i(g))}return u}function gs({nodes:e,nodeId:t,handleId:n,handleType:o}){return e.reduce((s,i)=>{if(i[K]){const{handleBounds:r}=i[K];let c=[],l=[];r&&(c=Kt(i,r,"source",`${t}-${n}-${o}`),l=Kt(i,r,"target",`${t}-${n}-${o}`)),s.push(...c,...l)}return s},[])}function _t(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function ht(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function ps(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function In({event:e,handleId:t,nodeId:n,onConnect:o,isTarget:s,getState:i,setState:r,isValidConnection:c,edgeUpdaterType:l,onReconnectEnd:u}){const a=mn(e.target),{connectionMode:d,domNode:p,autoPanOnConnect:f,connectionRadius:S,onConnectStart:g,panBy:m,getNodes:y,cancelConnection:x}=i();let b=0,v;const{x:H,y:I}=Se(e),L=a?.elementFromPoint(H,I),k=_t(l,L),C=p?.getBoundingClientRect();if(!C||!k)return;let $,R=Se(e,C),T=!1,M=null,E=!1,A=null;const V=gs({nodes:y(),nodeId:n,handleId:t,handleType:k}),Z=()=>{if(!f)return;const[_,P]=hn(R,C);m({x:_,y:P}),b=requestAnimationFrame(Z)};r({connectionPosition:R,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:k,connectionStartHandle:{nodeId:n,handleId:t,type:k},connectionEndHandle:null}),g?.(e,{nodeId:n,handleId:t,handleType:k});function F(_){const{transform:P}=i();R=Se(_,C);const{handle:D,validHandleResult:O}=us(_,a,Ct(R,P,!1,[1,1]),S,V,Y=>$n(Y,d,n,t,s?"target":"source",c,a));if(v=D,T||(Z(),T=!0),A=O.handleDomNode,M=O.connection,E=O.isValid,r({connectionPosition:v&&E?bn({x:v.x,y:v.y},P):R,connectionStatus:ps(!!v,E),connectionEndHandle:O.endHandle}),!v&&!E&&!A)return ht($);M.source!==M.target&&A&&(ht($),$=A,A.classList.add("connecting","react-flow__handle-connecting"),A.classList.toggle("valid",E),A.classList.toggle("react-flow__handle-valid",E))}function w(_){(v||A)&&M&&E&&o?.(M),i().onConnectEnd?.(_),l&&u?.(_),ht($),x(),cancelAnimationFrame(b),T=!1,E=!1,M=null,A=null,a.removeEventListener("mousemove",F),a.removeEventListener("mouseup",w),a.removeEventListener("touchmove",F),a.removeEventListener("touchend",w)}a.addEventListener("mousemove",F),a.addEventListener("mouseup",w),a.addEventListener("touchmove",F),a.addEventListener("touchend",w)}const jt=()=>!0,hs=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),ms=(e,t,n)=>o=>{const{connectionStartHandle:s,connectionEndHandle:i,connectionClickStartHandle:r}=o;return{connecting:s?.nodeId===e&&s?.handleId===t&&s?.type===n||i?.nodeId===e&&i?.handleId===t&&i?.type===n,clickConnecting:r?.nodeId===e&&r?.handleId===t&&r?.type===n}},Rn=h.forwardRef(({type:e="source",position:t=z.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:r,onConnect:c,children:l,className:u,onMouseDown:a,onTouchStart:d,...p},f)=>{const S=r||null,g=e==="target",m=ne(),y=is(),{connectOnClick:x,noPanClassName:b}=q(hs,se),{connecting:v,clickConnecting:H}=q(ms(y,S,e),se);y||m.getState().onError?.("010",me.error010());const I=C=>{const{defaultEdgeOptions:$,onConnect:R,hasDefaultEdges:T}=m.getState(),M={...$,...C};if(T){const{edges:E,setEdges:A}=m.getState();A(ds(M,E))}R?.(M),c?.(M)},L=C=>{if(!y)return;const $=xn(C);s&&($&&C.button===0||!$)&&In({event:C,handleId:S,nodeId:y,onConnect:I,isTarget:g,getState:m.getState,setState:m.setState,isValidConnection:n||m.getState().isValidConnection||jt}),$?a?.(C):d?.(C)},k=C=>{const{onClickConnectStart:$,onClickConnectEnd:R,connectionClickStartHandle:T,connectionMode:M,isValidConnection:E}=m.getState();if(!y||!T&&!s)return;if(!T){$?.(C,{nodeId:y,handleId:S,handleType:e}),m.setState({connectionClickStartHandle:{nodeId:y,type:e,handleId:S}});return}const A=mn(C.target),V=n||E||jt,{connection:Z,isValid:F}=$n({nodeId:y,id:S,type:e},M,T.nodeId,T.handleId||null,T.type,V,A);F&&I(Z),R?.(C),m.setState({connectionClickStartHandle:null})};return N.createElement("div",{"data-handleid":S,"data-nodeid":y,"data-handlepos":t,"data-id":`${y}-${S}-${e}`,className:ue(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,u,{source:!g,target:g,connectable:o,connectablestart:s,connectableend:i,connecting:H,connectionindicator:o&&(s&&!v||i&&v)}]),onMouseDown:L,onTouchStart:L,onClick:x?k:void 0,ref:f,...p},l)});Rn.displayName="Handle";var at=h.memo(Rn);const Tn=({data:e,isConnectable:t,targetPosition:n=z.Top,sourcePosition:o=z.Bottom})=>N.createElement(N.Fragment,null,N.createElement(at,{type:"target",position:n,isConnectable:t}),e?.label,N.createElement(at,{type:"source",position:o,isConnectable:t}));Tn.displayName="DefaultNode";var vt=h.memo(Tn);const Hn=({data:e,isConnectable:t,sourcePosition:n=z.Bottom})=>N.createElement(N.Fragment,null,e?.label,N.createElement(at,{type:"source",position:n,isConnectable:t}));Hn.displayName="InputNode";var Pn=h.memo(Hn);const Dn=({data:e,isConnectable:t,targetPosition:n=z.Top})=>N.createElement(N.Fragment,null,N.createElement(at,{type:"target",position:n,isConnectable:t}),e?.label);Dn.displayName="OutputNode";var kn=h.memo(Dn);const zt=()=>null;zt.displayName="GroupNode";const ys=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),nt=e=>e.id;function xs(e,t){return se(e.selectedNodes.map(nt),t.selectedNodes.map(nt))&&se(e.selectedEdges.map(nt),t.selectedEdges.map(nt))}const _n=h.memo(({onSelectionChange:e})=>{const t=ne(),{selectedNodes:n,selectedEdges:o}=q(ys,xs);return h.useEffect(()=>{const s={nodes:n,edges:o};e?.(s),t.getState().onSelectionChange.forEach(i=>i(s))},[n,o,e]),null});_n.displayName="SelectionListener";const Es=e=>!!e.onSelectionChange;function Ss({onSelectionChange:e}){const t=q(Es);return e||t?N.createElement(_n,{onSelectionChange:e}):null}const ws=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function ze(e,t){h.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function U(e,t,n){h.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const Ns=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:s,onConnectStart:i,onConnectEnd:r,onClickConnectStart:c,onClickConnectEnd:l,nodesDraggable:u,nodesConnectable:a,nodesFocusable:d,edgesFocusable:p,edgesUpdatable:f,elevateNodesOnSelect:S,minZoom:g,maxZoom:m,nodeExtent:y,onNodesChange:x,onEdgesChange:b,elementsSelectable:v,connectionMode:H,snapGrid:I,snapToGrid:L,translateExtent:k,connectOnClick:C,defaultEdgeOptions:$,fitView:R,fitViewOptions:T,onNodesDelete:M,onEdgesDelete:E,onNodeDrag:A,onNodeDragStart:V,onNodeDragStop:Z,onSelectionDrag:F,onSelectionDragStart:w,onSelectionDragStop:_,noPanClassName:P,nodeOrigin:D,rfId:O,autoPanOnConnect:Y,autoPanOnNodeDrag:X,onError:j,connectionRadius:ee,isValidConnection:te,nodeDragThreshold:J})=>{const{setNodes:W,setEdges:le,setDefaultNodesAndEdges:ie,setMinZoom:de,setMaxZoom:ce,setTranslateExtent:Q,setNodeExtent:fe,reset:G}=q(ws,se),B=ne();return h.useEffect(()=>{const re=o?.map(we=>({...we,...$}));return ie(n,re),()=>{G()}},[]),U("defaultEdgeOptions",$,B.setState),U("connectionMode",H,B.setState),U("onConnect",s,B.setState),U("onConnectStart",i,B.setState),U("onConnectEnd",r,B.setState),U("onClickConnectStart",c,B.setState),U("onClickConnectEnd",l,B.setState),U("nodesDraggable",u,B.setState),U("nodesConnectable",a,B.setState),U("nodesFocusable",d,B.setState),U("edgesFocusable",p,B.setState),U("edgesUpdatable",f,B.setState),U("elementsSelectable",v,B.setState),U("elevateNodesOnSelect",S,B.setState),U("snapToGrid",L,B.setState),U("snapGrid",I,B.setState),U("onNodesChange",x,B.setState),U("onEdgesChange",b,B.setState),U("connectOnClick",C,B.setState),U("fitViewOnInit",R,B.setState),U("fitViewOnInitOptions",T,B.setState),U("onNodesDelete",M,B.setState),U("onEdgesDelete",E,B.setState),U("onNodeDrag",A,B.setState),U("onNodeDragStart",V,B.setState),U("onNodeDragStop",Z,B.setState),U("onSelectionDrag",F,B.setState),U("onSelectionDragStart",w,B.setState),U("onSelectionDragStop",_,B.setState),U("noPanClassName",P,B.setState),U("nodeOrigin",D,B.setState),U("rfId",O,B.setState),U("autoPanOnConnect",Y,B.setState),U("autoPanOnNodeDrag",X,B.setState),U("onError",j,B.setState),U("connectionRadius",ee,B.setState),U("isValidConnection",te,B.setState),U("nodeDragThreshold",J,B.setState),ze(e,W),ze(t,le),ze(g,de),ze(m,ce),ze(k,Q),ze(y,fe),null},qt={display:"none"},bs={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},zn="react-flow__node-desc",Bn="react-flow__edge-desc",Cs="react-flow__aria-live",vs=e=>e.ariaLiveMessage;function Ms({rfId:e}){const t=q(vs);return N.createElement("div",{id:`${Cs}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:bs},t)}function As({rfId:e,disableKeyboardA11y:t}){return N.createElement(N.Fragment,null,N.createElement("div",{id:`${zn}-${e}`,style:qt},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),N.createElement("div",{id:`${Bn}-${e}`,style:qt},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&N.createElement(Ms,{rfId:e}))}var Je=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,o]=h.useState(!1),s=h.useRef(!1),i=h.useRef(new Set([])),[r,c]=h.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),a=u.reduce((d,p)=>d.concat(...p),[]);return[u,a]}return[[],[]]},[e]);return h.useEffect(()=>{const l=typeof document<"u"?document:null,u=t?.target||l;if(e!==null){const a=f=>{if(s.current=f.ctrlKey||f.metaKey||f.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&wt(f))return!1;const g=Jt(f.code,c);i.current.add(f[g]),Qt(r,i.current,!1)&&(f.preventDefault(),o(!0))},d=f=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&wt(f))return!1;const g=Jt(f.code,c);Qt(r,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(f[g]),f.key==="Meta"&&i.current.clear(),s.current=!1},p=()=>{i.current.clear(),o(!1)};return u?.addEventListener("keydown",a),u?.addEventListener("keyup",d),window.addEventListener("blur",p),()=>{u?.removeEventListener("keydown",a),u?.removeEventListener("keyup",d),window.removeEventListener("blur",p)}}},[e,o]),n};function Qt(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function Jt(e,t){return t.includes(e)?"code":"key"}function Vn(e,t,n,o){const s=e.parentNode||e.parentId;if(!s)return n;const i=t.get(s),r=Ze(i,o);return Vn(i,t,{x:(n.x??0)+r.x,y:(n.y??0)+r.y,z:(i[K]?.z??0)>(n.z??0)?i[K]?.z??0:n.z??0},o)}function Ln(e,t,n){e.forEach(o=>{const s=o.parentNode||o.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||n?.[o.id]){const{x:i,y:r,z:c}=Vn(o,e,{...o.position,z:o[K]?.z??0},t);o.positionAbsolute={x:i,y:r},o[K].z=c,n?.[o.id]&&(o[K].isParent=!0)}})}function mt(e,t,n,o){const s=new Map,i={},r=o?1e3:0;return e.forEach(c=>{const l=(ae(c.zIndex)?c.zIndex:0)+(c.selected?r:0),u=t.get(c.id),a={...c,positionAbsolute:{x:c.position.x,y:c.position.y}},d=c.parentNode||c.parentId;d&&(i[d]=!0);const p=u?.type&&u?.type!==c.type;Object.defineProperty(a,K,{enumerable:!1,value:{handleBounds:p?void 0:u?.[K]?.handleBounds,z:l}}),s.set(c.id,a)}),Ln(s,n,i),s}function On(e,t={}){const{getNodes:n,width:o,height:s,minZoom:i,maxZoom:r,d3Zoom:c,d3Selection:l,fitViewOnInitDone:u,fitViewOnInit:a,nodeOrigin:d}=e(),p=t.initial&&!u&&a;if(c&&l&&(p||!t.initial)){const S=n().filter(m=>{const y=t.includeHiddenNodes?m.width&&m.height:!m.hidden;return t.nodes?.length?y&&t.nodes.some(x=>x.id===m.id):y}),g=S.every(m=>m.width&&m.height);if(S.length>0&&g){const m=kt(S,d),{x:y,y:x,zoom:b}=Mn(m,o,s,t.minZoom??i,t.maxZoom??r,t.padding??.1),v=Fe.translate(y,x).scale(b);return typeof t.duration=="number"&&t.duration>0?c.transform($e(l,t.duration),v):c.transform(l,v),!0}}return!1}function $s(e,t){return e.forEach(n=>{const o=t.get(n.id);o&&t.set(o.id,{...o,[K]:o[K],selected:n.selected})}),new Map(t)}function Is(e,t){return t.map(n=>{const o=e.find(s=>s.id===n.id);return o&&(n.selected=o.selected),n})}function ot({changedNodes:e,changedEdges:t,get:n,set:o}){const{nodeInternals:s,edges:i,onNodesChange:r,onEdgesChange:c,hasDefaultNodes:l,hasDefaultEdges:u}=n();e?.length&&(l&&o({nodeInternals:$s(e,s)}),r?.(e)),t?.length&&(u&&o({edges:Is(t,i)}),c?.(t))}const Be=()=>{},Rs={zoomIn:Be,zoomOut:Be,zoomTo:Be,getZoom:()=>1,setViewport:Be,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Be,fitBounds:Be,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Ts=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),Hs=()=>{const e=ne(),{d3Zoom:t,d3Selection:n}=q(Ts,se);return h.useMemo(()=>n&&t?{zoomIn:s=>t.scaleBy($e(n,s?.duration),1.2),zoomOut:s=>t.scaleBy($e(n,s?.duration),1/1.2),zoomTo:(s,i)=>t.scaleTo($e(n,i?.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,i)=>{const[r,c,l]=e.getState().transform,u=Fe.translate(s.x??r,s.y??c).scale(s.zoom??l);t.transform($e(n,i?.duration),u)},getViewport:()=>{const[s,i,r]=e.getState().transform;return{x:s,y:i,zoom:r}},fitView:s=>On(e.getState,s),setCenter:(s,i,r)=>{const{width:c,height:l,maxZoom:u}=e.getState(),a=typeof r?.zoom<"u"?r.zoom:u,d=c/2-s*a,p=l/2-i*a,f=Fe.translate(d,p).scale(a);t.transform($e(n,r?.duration),f)},fitBounds:(s,i)=>{const{width:r,height:c,minZoom:l,maxZoom:u}=e.getState(),{x:a,y:d,zoom:p}=Mn(s,r,c,l,u,i?.padding??.1),f=Fe.translate(a,d).scale(p);t.transform($e(n,i?.duration),f)},project:s=>{const{transform:i,snapToGrid:r,snapGrid:c}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Ct(s,i,r,c)},screenToFlowPosition:s=>{const{transform:i,snapToGrid:r,snapGrid:c,domNode:l}=e.getState();if(!l)return s;const{x:u,y:a}=l.getBoundingClientRect(),d={x:s.x-u,y:s.y-a};return Ct(d,i,r,c)},flowToScreenPosition:s=>{const{transform:i,domNode:r}=e.getState();if(!r)return s;const{x:c,y:l}=r.getBoundingClientRect(),u=bn(s,i);return{x:u.x+c,y:u.y+l}},viewportInitialized:!0}:Rs,[t,n])};function Fn(){const e=Hs(),t=ne(),n=h.useCallback(()=>t.getState().getNodes().map(g=>({...g})),[]),o=h.useCallback(g=>t.getState().nodeInternals.get(g),[]),s=h.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(m=>({...m}))},[]),i=h.useCallback(g=>{const{edges:m=[]}=t.getState();return m.find(y=>y.id===g)},[]),r=h.useCallback(g=>{const{getNodes:m,setNodes:y,hasDefaultNodes:x,onNodesChange:b}=t.getState(),v=m(),H=typeof g=="function"?g(v):g;if(x)y(H);else if(b){const I=H.length===0?v.map(L=>({type:"remove",id:L.id})):H.map(L=>({item:L,type:"reset"}));b(I)}},[]),c=h.useCallback(g=>{const{edges:m=[],setEdges:y,hasDefaultEdges:x,onEdgesChange:b}=t.getState(),v=typeof g=="function"?g(m):g;if(x)y(v);else if(b){const H=v.length===0?m.map(I=>({type:"remove",id:I.id})):v.map(I=>({item:I,type:"reset"}));b(H)}},[]),l=h.useCallback(g=>{const m=Array.isArray(g)?g:[g],{getNodes:y,setNodes:x,hasDefaultNodes:b,onNodesChange:v}=t.getState();if(b){const I=[...y(),...m];x(I)}else if(v){const H=m.map(I=>({item:I,type:"add"}));v(H)}},[]),u=h.useCallback(g=>{const m=Array.isArray(g)?g:[g],{edges:y=[],setEdges:x,hasDefaultEdges:b,onEdgesChange:v}=t.getState();if(b)x([...y,...m]);else if(v){const H=m.map(I=>({item:I,type:"add"}));v(H)}},[]),a=h.useCallback(()=>{const{getNodes:g,edges:m=[],transform:y}=t.getState(),[x,b,v]=y;return{nodes:g().map(H=>({...H})),edges:m.map(H=>({...H})),viewport:{x,y:b,zoom:v}}},[]),d=h.useCallback(({nodes:g,edges:m})=>{const{nodeInternals:y,getNodes:x,edges:b,hasDefaultNodes:v,hasDefaultEdges:H,onNodesDelete:I,onEdgesDelete:L,onNodesChange:k,onEdgesChange:C}=t.getState(),$=(g||[]).map(A=>A.id),R=(m||[]).map(A=>A.id),T=x().reduce((A,V)=>{const Z=V.parentNode||V.parentId,F=!$.includes(V.id)&&Z&&A.find(_=>_.id===Z);return(typeof V.deletable=="boolean"?V.deletable:!0)&&($.includes(V.id)||F)&&A.push(V),A},[]),M=b.filter(A=>typeof A.deletable=="boolean"?A.deletable:!0),E=M.filter(A=>R.includes(A.id));if(T||E){const A=vn(T,M),V=[...E,...A],Z=V.reduce((F,w)=>(F.includes(w.id)||F.push(w.id),F),[]);if((H||v)&&(H&&t.setState({edges:b.filter(F=>!Z.includes(F.id))}),v&&(T.forEach(F=>{y.delete(F.id)}),t.setState({nodeInternals:new Map(y)}))),Z.length>0&&(L?.(V),C&&C(Z.map(F=>({id:F,type:"remove"})))),T.length>0&&(I?.(T),k)){const F=T.map(w=>({id:w.id,type:"remove"}));k(F)}}},[]),p=h.useCallback(g=>{const m=Qo(g),y=m?null:t.getState().nodeInternals.get(g.id);return!m&&!y?[null,null,m]:[m?g:Yt(y),y,m]},[]),f=h.useCallback((g,m=!0,y)=>{const[x,b,v]=p(g);return x?(y||t.getState().getNodes()).filter(H=>{if(!v&&(H.id===b.id||!H.positionAbsolute))return!1;const I=Yt(H),L=St(I,x);return m&&L>0||L>=x.width*x.height}):[]},[]),S=h.useCallback((g,m,y=!0)=>{const[x]=p(g);if(!x)return!1;const b=St(x,m);return y&&b>0||b>=x.width*x.height},[]);return h.useMemo(()=>({...e,getNodes:n,getNode:o,getEdges:s,getEdge:i,setNodes:r,setEdges:c,addNodes:l,addEdges:u,toObject:a,deleteElements:d,getIntersectingNodes:f,isNodeIntersecting:S}),[e,n,o,s,i,r,c,l,u,a,d,f,S])}const Ps={actInsideInputWithModifier:!1};var Ds=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=ne(),{deleteElements:o}=Fn(),s=Je(e,Ps),i=Je(t);h.useEffect(()=>{if(s){const{edges:r,getNodes:c}=n.getState(),l=c().filter(a=>a.selected),u=r.filter(a=>a.selected);o({nodes:l,edges:u}),n.setState({nodesSelectionActive:!1})}},[s]),h.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function ks(e){const t=ne();h.useEffect(()=>{let n;const o=()=>{if(!e.current)return;const s=$t(e.current);(s.height===0||s.width===0)&&t.getState().onError?.("004",me.error004()),t.setState({width:s.width||500,height:s.height||500})};return o(),window.addEventListener("resize",o),e.current&&(n=new ResizeObserver(()=>o()),n.observe(e.current)),()=>{window.removeEventListener("resize",o),n&&e.current&&n.unobserve(e.current)}},[])}const Bt={position:"absolute",width:"100%",height:"100%",top:0,left:0},_s=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,st=e=>({x:e.x,y:e.y,zoom:e.k}),Ve=(e,t)=>e.target.closest(`.${t}`),en=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),tn=e=>{const t=e.ctrlKey&&rt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},zs=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Bs=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:o,zoomOnScroll:s=!0,zoomOnPinch:i=!0,panOnScroll:r=!1,panOnScrollSpeed:c=.5,panOnScrollMode:l=Ie.Free,zoomOnDoubleClick:u=!0,elementsSelectable:a,panOnDrag:d=!0,defaultViewport:p,translateExtent:f,minZoom:S,maxZoom:g,zoomActivationKeyCode:m,preventScrolling:y=!0,children:x,noWheelClassName:b,noPanClassName:v})=>{const H=h.useRef(),I=ne(),L=h.useRef(!1),k=h.useRef(!1),C=h.useRef(null),$=h.useRef({x:0,y:0,zoom:0}),{d3Zoom:R,d3Selection:T,d3ZoomHandler:M,userSelectionActive:E}=q(zs,se),A=Je(m),V=h.useRef(0),Z=h.useRef(!1),F=h.useRef();return ks(C),h.useEffect(()=>{if(C.current){const w=C.current.getBoundingClientRect(),_=Oo().scaleExtent([S,g]).translateExtent(f),P=gn(C.current).call(_),D=Fe.translate(p.x,p.y).scale(Ue(p.zoom,S,g)),O=[[0,0],[w.width,w.height]],Y=_.constrain()(D,O,f);_.transform(P,Y),_.wheelDelta(tn),I.setState({d3Zoom:_,d3Selection:P,d3ZoomHandler:P.on("wheel.zoom"),transform:[Y.x,Y.y,Y.k],domNode:C.current.closest(".react-flow")})}},[]),h.useEffect(()=>{T&&R&&(r&&!A&&!E?T.on("wheel.zoom",w=>{if(Ve(w,b))return!1;w.preventDefault(),w.stopImmediatePropagation();const _=T.property("__zoom").k||1;if(w.ctrlKey&&i){const te=Fo(w),J=tn(w),W=_*Math.pow(2,J);R.scaleTo(T,W,te,w);return}const P=w.deltaMode===1?20:1;let D=l===Ie.Vertical?0:w.deltaX*P,O=l===Ie.Horizontal?0:w.deltaY*P;!rt()&&w.shiftKey&&l!==Ie.Vertical&&(D=w.deltaY*P,O=0),R.translateBy(T,-(D/_)*c,-(O/_)*c,{internal:!0});const Y=st(T.property("__zoom")),{onViewportChangeStart:X,onViewportChange:j,onViewportChangeEnd:ee}=I.getState();clearTimeout(F.current),Z.current||(Z.current=!0,t?.(w,Y),X?.(Y)),Z.current&&(e?.(w,Y),j?.(Y),F.current=setTimeout(()=>{n?.(w,Y),ee?.(Y),Z.current=!1},150))},{passive:!1}):typeof M<"u"&&T.on("wheel.zoom",function(w,_){if(!y&&w.type==="wheel"&&!w.ctrlKey||Ve(w,b))return null;w.preventDefault(),M.call(this,w,_)},{passive:!1}))},[E,r,l,T,R,M,A,i,y,b,t,e,n]),h.useEffect(()=>{R&&R.on("start",w=>{if(!w.sourceEvent||w.sourceEvent.internal)return null;V.current=w.sourceEvent?.button;const{onViewportChangeStart:_}=I.getState(),P=st(w.transform);L.current=!0,$.current=P,w.sourceEvent?.type==="mousedown"&&I.setState({paneDragging:!0}),_?.(P),t?.(w.sourceEvent,P)})},[R,t]),h.useEffect(()=>{R&&(E&&!L.current?R.on("zoom",null):E||R.on("zoom",w=>{const{onViewportChange:_}=I.getState();if(I.setState({transform:[w.transform.x,w.transform.y,w.transform.k]}),k.current=!!(o&&en(d,V.current??0)),(e||_)&&!w.sourceEvent?.internal){const P=st(w.transform);_?.(P),e?.(w.sourceEvent,P)}}))},[E,R,e,d,o]),h.useEffect(()=>{R&&R.on("end",w=>{if(!w.sourceEvent||w.sourceEvent.internal)return null;const{onViewportChangeEnd:_}=I.getState();if(L.current=!1,I.setState({paneDragging:!1}),o&&en(d,V.current??0)&&!k.current&&o(w.sourceEvent),k.current=!1,(n||_)&&_s($.current,w.transform)){const P=st(w.transform);$.current=P,clearTimeout(H.current),H.current=setTimeout(()=>{_?.(P),n?.(w.sourceEvent,P)},r?150:0)}})},[R,r,d,n,o]),h.useEffect(()=>{R&&R.filter(w=>{const _=A||s,P=i&&w.ctrlKey;if((d===!0||Array.isArray(d)&&d.includes(1))&&w.button===1&&w.type==="mousedown"&&(Ve(w,"react-flow__node")||Ve(w,"react-flow__edge")))return!0;if(!d&&!_&&!r&&!u&&!i||E||!u&&w.type==="dblclick"||Ve(w,b)&&w.type==="wheel"||Ve(w,v)&&(w.type!=="wheel"||r&&w.type==="wheel"&&!A)||!i&&w.ctrlKey&&w.type==="wheel"||!_&&!r&&!P&&w.type==="wheel"||!d&&(w.type==="mousedown"||w.type==="touchstart")||Array.isArray(d)&&!d.includes(w.button)&&w.type==="mousedown")return!1;const D=Array.isArray(d)&&d.includes(w.button)||!w.button||w.button<=1;return(!w.ctrlKey||w.type==="wheel")&&D})},[E,R,s,i,r,u,d,a,A]),N.createElement("div",{className:"react-flow__renderer",ref:C,style:Bt},x)},Vs=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Ls(){const{userSelectionActive:e,userSelectionRect:t}=q(Vs,se);return e&&t?N.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function nn(e,t){const n=t.parentNode||t.parentId,o=e.find(s=>s.id===n);if(o){const s=t.position.x+t.width-o.width,i=t.position.y+t.height-o.height;if(s>0||i>0||t.position.x<0||t.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,s>0&&(o.style.width+=s),i>0&&(o.style.height+=i),t.position.x<0){const r=Math.abs(t.position.x);o.position.x=o.position.x-r,o.style.width+=r,t.position.x=0}if(t.position.y<0){const r=Math.abs(t.position.y);o.position.y=o.position.y-r,o.style.height+=r,t.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function Zn(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const n=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,s)=>{const i=e.filter(c=>c.id===s.id);if(i.length===0)return o.push(s),o;const r={...s};for(const c of i)if(c)switch(c.type){case"select":{r.selected=c.selected;break}case"position":{typeof c.position<"u"&&(r.position=c.position),typeof c.positionAbsolute<"u"&&(r.positionAbsolute=c.positionAbsolute),typeof c.dragging<"u"&&(r.dragging=c.dragging),r.expandParent&&nn(o,r);break}case"dimensions":{typeof c.dimensions<"u"&&(r.width=c.dimensions.width,r.height=c.dimensions.height),typeof c.updateStyle<"u"&&(r.style={...r.style||{},...c.dimensions}),typeof c.resizing=="boolean"&&(r.resizing=c.resizing),r.expandParent&&nn(o,r);break}case"remove":return o}return o.push(r),o},n)}function Yn(e,t){return Zn(e,t)}function Os(e,t){return Zn(e,t)}const xe=(e,t)=>({id:e,type:"select",selected:t});function Oe(e,t){return e.reduce((n,o)=>{const s=t.includes(o.id);return!o.selected&&s?(o.selected=!0,n.push(xe(o.id,!0))):o.selected&&!s&&(o.selected=!1,n.push(xe(o.id,!1))),n},[])}const yt=(e,t)=>n=>{n.target===t.current&&e?.(n)},Fs=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Un=h.memo(({isSelecting:e,selectionMode:t=Qe.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:s,onPaneClick:i,onPaneContextMenu:r,onPaneScroll:c,onPaneMouseEnter:l,onPaneMouseMove:u,onPaneMouseLeave:a,children:d})=>{const p=h.useRef(null),f=ne(),S=h.useRef(0),g=h.useRef(0),m=h.useRef(),{userSelectionActive:y,elementsSelectable:x,dragging:b}=q(Fs,se),v=()=>{f.setState({userSelectionActive:!1,userSelectionRect:null}),S.current=0,g.current=0},H=M=>{i?.(M),f.getState().resetSelectedElements(),f.setState({nodesSelectionActive:!1})},I=M=>{if(Array.isArray(n)&&n?.includes(2)){M.preventDefault();return}r?.(M)},L=c?M=>c(M):void 0,k=M=>{const{resetSelectedElements:E,domNode:A}=f.getState();if(m.current=A?.getBoundingClientRect(),!x||!e||M.button!==0||M.target!==p.current||!m.current)return;const{x:V,y:Z}=Se(M,m.current);E(),f.setState({userSelectionRect:{width:0,height:0,startX:V,startY:Z,x:V,y:Z}}),o?.(M)},C=M=>{const{userSelectionRect:E,nodeInternals:A,edges:V,transform:Z,onNodesChange:F,onEdgesChange:w,nodeOrigin:_,getNodes:P}=f.getState();if(!e||!m.current||!E)return;f.setState({userSelectionActive:!0,nodesSelectionActive:!1});const D=Se(M,m.current),O=E.startX??0,Y=E.startY??0,X={...E,x:D.x<O?D.x:O,y:D.y<Y?D.y:Y,width:Math.abs(D.x-O),height:Math.abs(D.y-Y)},j=P(),ee=Cn(A,X,Z,t===Qe.Partial,!0,_),te=vn(ee,V).map(W=>W.id),J=ee.map(W=>W.id);if(S.current!==J.length){S.current=J.length;const W=Oe(j,J);W.length&&F?.(W)}if(g.current!==te.length){g.current=te.length;const W=Oe(V,te);W.length&&w?.(W)}f.setState({userSelectionRect:X})},$=M=>{if(M.button!==0)return;const{userSelectionRect:E}=f.getState();!y&&E&&M.target===p.current&&H?.(M),f.setState({nodesSelectionActive:S.current>0}),v(),s?.(M)},R=M=>{y&&(f.setState({nodesSelectionActive:S.current>0}),s?.(M)),v()},T=x&&(e||y);return N.createElement("div",{className:ue(["react-flow__pane",{dragging:b,selection:e}]),onClick:T?void 0:yt(H,p),onContextMenu:yt(I,p),onWheel:yt(L,p),onMouseEnter:T?void 0:l,onMouseDown:T?k:void 0,onMouseMove:T?C:u,onMouseUp:T?$:void 0,onMouseLeave:T?R:a,ref:p,style:Bt},d,N.createElement(Ls,null))});Un.displayName="Pane";function Xn(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const o=t.get(n);return o?o.selected?!0:Xn(o,t):!1}function on(e,t,n){let o=e;do{if(o?.matches(t))return!0;if(o===n.current)return!1;o=o.parentElement}while(o);return!1}function Zs(e,t,n,o){return Array.from(e.values()).filter(s=>(s.selected||s.id===o)&&(!s.parentNode||s.parentId||!Xn(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>({id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:n.x-(s.positionAbsolute?.x??0),y:n.y-(s.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}))}function Ys(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function Wn(e,t,n,o,s=[0,0],i){const r=Ys(e,e.extent||o);let c=r;const l=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(l&&e.width&&e.height){const d=n.get(l),{x:p,y:f}=Ze(d,s).positionAbsolute;c=d&&ae(p)&&ae(f)&&ae(d.width)&&ae(d.height)?[[p+e.width*s[0],f+e.height*s[1]],[p+d.width-e.width+e.width*s[0],f+d.height-e.height+e.height*s[1]]]:c}else i?.("005",me.error005()),c=r;else if(e.extent&&l&&e.extent!=="parent"){const d=n.get(l),{x:p,y:f}=Ze(d,s).positionAbsolute;c=[[e.extent[0][0]+p,e.extent[0][1]+f],[e.extent[1][0]+p,e.extent[1][1]+f]]}let u={x:0,y:0};if(l){const d=n.get(l);u=Ze(d,s).positionAbsolute}const a=c&&c!=="parent"?It(t,c):t;return{position:{x:a.x-u.x,y:a.y-u.y},positionAbsolute:a}}function xt({nodeId:e,dragItems:t,nodeInternals:n}){const o=t.map(s=>({...n.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?o.find(s=>s.id===e):o[0],o]}const sn=(e,t,n,o)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const i=Array.from(s),r=t.getBoundingClientRect(),c={x:r.width*o[0],y:r.height*o[1]};return i.map(l=>{const u=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(u.left-r.left-c.x)/n,y:(u.top-r.top-c.y)/n,...$t(l)}})};function je(e,t,n){return n===void 0?n:o=>{const s=t().nodeInternals.get(e);s&&n(o,{...s})}}function Mt({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:r,nodeInternals:c,onError:l}=t.getState(),u=c.get(e);if(!u){l?.("012",me.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&r)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):s([e])}function Us(){const e=ne();return h.useCallback(({sourceEvent:n})=>{const{transform:o,snapGrid:s,snapToGrid:i}=e.getState(),r=n.touches?n.touches[0].clientX:n.clientX,c=n.touches?n.touches[0].clientY:n.clientY,l={x:(r-o[0])/o[2],y:(c-o[1])/o[2]};return{xSnapped:i?s[0]*Math.round(l.x/s[0]):l.x,ySnapped:i?s[1]*Math.round(l.y/s[1]):l.y,...l}},[])}function Et(e){return(t,n,o)=>e?.(t,o)}function Gn({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:i,selectNodesOnDrag:r}){const c=ne(),[l,u]=h.useState(!1),a=h.useRef([]),d=h.useRef({x:null,y:null}),p=h.useRef(0),f=h.useRef(null),S=h.useRef({x:0,y:0}),g=h.useRef(null),m=h.useRef(!1),y=h.useRef(!1),x=h.useRef(!1),b=Us();return h.useEffect(()=>{if(e?.current){const v=gn(e.current),H=({x:k,y:C})=>{const{nodeInternals:$,onNodeDrag:R,onSelectionDrag:T,updateNodePositions:M,nodeExtent:E,snapGrid:A,snapToGrid:V,nodeOrigin:Z,onError:F}=c.getState();d.current={x:k,y:C};let w=!1,_={x:0,y:0,x2:0,y2:0};if(a.current.length>1&&E){const D=kt(a.current,Z);_=Rt(D)}if(a.current=a.current.map(D=>{const O={x:k-D.distance.x,y:C-D.distance.y};V&&(O.x=A[0]*Math.round(O.x/A[0]),O.y=A[1]*Math.round(O.y/A[1]));const Y=[[E[0][0],E[0][1]],[E[1][0],E[1][1]]];a.current.length>1&&E&&!D.extent&&(Y[0][0]=D.positionAbsolute.x-_.x+E[0][0],Y[1][0]=D.positionAbsolute.x+(D.width??0)-_.x2+E[1][0],Y[0][1]=D.positionAbsolute.y-_.y+E[0][1],Y[1][1]=D.positionAbsolute.y+(D.height??0)-_.y2+E[1][1]);const X=Wn(D,O,$,Y,Z,F);return w=w||D.position.x!==X.position.x||D.position.y!==X.position.y,D.position=X.position,D.positionAbsolute=X.positionAbsolute,D}),!w)return;M(a.current,!0,!0),u(!0);const P=s?R:Et(T);if(P&&g.current){const[D,O]=xt({nodeId:s,dragItems:a.current,nodeInternals:$});P(g.current,D,O)}},I=()=>{if(!f.current)return;const[k,C]=hn(S.current,f.current);if(k!==0||C!==0){const{transform:$,panBy:R}=c.getState();d.current.x=(d.current.x??0)-k/$[2],d.current.y=(d.current.y??0)-C/$[2],R({x:k,y:C})&&H(d.current)}p.current=requestAnimationFrame(I)},L=k=>{const{nodeInternals:C,multiSelectionActive:$,nodesDraggable:R,unselectNodesAndEdges:T,onNodeDragStart:M,onSelectionDragStart:E}=c.getState();y.current=!0;const A=s?M:Et(E);(!r||!i)&&!$&&s&&(C.get(s)?.selected||T()),s&&i&&r&&Mt({id:s,store:c,nodeRef:e});const V=b(k);if(d.current=V,a.current=Zs(C,R,V,s),A&&a.current){const[Z,F]=xt({nodeId:s,dragItems:a.current,nodeInternals:C});A(k.sourceEvent,Z,F)}};if(t)v.on(".drag",null);else{const k=Zo().on("start",C=>{const{domNode:$,nodeDragThreshold:R}=c.getState();R===0&&L(C),x.current=!1;const T=b(C);d.current=T,f.current=$?.getBoundingClientRect()||null,S.current=Se(C.sourceEvent,f.current)}).on("drag",C=>{const $=b(C),{autoPanOnNodeDrag:R,nodeDragThreshold:T}=c.getState();if(C.sourceEvent.type==="touchmove"&&C.sourceEvent.touches.length>1&&(x.current=!0),!x.current){if(!m.current&&y.current&&R&&(m.current=!0,I()),!y.current){const M=$.xSnapped-(d?.current?.x??0),E=$.ySnapped-(d?.current?.y??0);Math.sqrt(M*M+E*E)>T&&L(C)}(d.current.x!==$.xSnapped||d.current.y!==$.ySnapped)&&a.current&&y.current&&(g.current=C.sourceEvent,S.current=Se(C.sourceEvent,f.current),H($))}}).on("end",C=>{if(!(!y.current||x.current)&&(u(!1),m.current=!1,y.current=!1,cancelAnimationFrame(p.current),a.current)){const{updateNodePositions:$,nodeInternals:R,onNodeDragStop:T,onSelectionDragStop:M}=c.getState(),E=s?T:Et(M);if($(a.current,!1,!1),E){const[A,V]=xt({nodeId:s,dragItems:a.current,nodeInternals:R});E(C.sourceEvent,A,V)}}}).filter(C=>{const $=C.target;return!C.button&&(!n||!on($,`.${n}`,e))&&(!o||on($,o,e))});return v.call(k),()=>{v.on(".drag",null)}}}},[e,t,n,o,i,c,s,r,b]),l}function Kn(){const e=ne();return h.useCallback(n=>{const{nodeInternals:o,nodeExtent:s,updateNodePositions:i,getNodes:r,snapToGrid:c,snapGrid:l,onError:u,nodesDraggable:a}=e.getState(),d=r().filter(x=>x.selected&&(x.draggable||a&&typeof x.draggable>"u")),p=c?l[0]:5,f=c?l[1]:5,S=n.isShiftPressed?4:1,g=n.x*p*S,m=n.y*f*S,y=d.map(x=>{if(x.positionAbsolute){const b={x:x.positionAbsolute.x+g,y:x.positionAbsolute.y+m};c&&(b.x=l[0]*Math.round(b.x/l[0]),b.y=l[1]*Math.round(b.y/l[1]));const{positionAbsolute:v,position:H}=Wn(x,b,o,s,void 0,u);x.position=H,x.positionAbsolute=v}return x});i(y,!0,!1)},[])}const Ye={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var qe=e=>{const t=({id:n,type:o,data:s,xPos:i,yPos:r,xPosOrigin:c,yPosOrigin:l,selected:u,onClick:a,onMouseEnter:d,onMouseMove:p,onMouseLeave:f,onContextMenu:S,onDoubleClick:g,style:m,className:y,isDraggable:x,isSelectable:b,isConnectable:v,isFocusable:H,selectNodesOnDrag:I,sourcePosition:L,targetPosition:k,hidden:C,resizeObserver:$,dragHandle:R,zIndex:T,isParent:M,noDragClassName:E,noPanClassName:A,initialized:V,disableKeyboardA11y:Z,ariaLabel:F,rfId:w,hasHandleBounds:_})=>{const P=ne(),D=h.useRef(null),O=h.useRef(null),Y=h.useRef(L),X=h.useRef(k),j=h.useRef(o),ee=b||x||a||d||p||f,te=Kn(),J=je(n,P.getState,d),W=je(n,P.getState,p),le=je(n,P.getState,f),ie=je(n,P.getState,S),de=je(n,P.getState,g),ce=G=>{const{nodeDragThreshold:B}=P.getState();if(b&&(!I||!x||B>0)&&Mt({id:n,store:P,nodeRef:D}),a){const re=P.getState().nodeInternals.get(n);re&&a(G,{...re})}},Q=G=>{if(!wt(G)&&!Z)if(yn.includes(G.key)&&b){const B=G.key==="Escape";Mt({id:n,store:P,unselect:B,nodeRef:D})}else x&&u&&Object.prototype.hasOwnProperty.call(Ye,G.key)&&(P.setState({ariaLiveMessage:`Moved selected node ${G.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~r}`}),te({x:Ye[G.key].x,y:Ye[G.key].y,isShiftPressed:G.shiftKey}))};h.useEffect(()=>()=>{O.current&&($?.unobserve(O.current),O.current=null)},[]),h.useEffect(()=>{if(D.current&&!C){const G=D.current;(!V||!_||O.current!==G)&&(O.current&&$?.unobserve(O.current),$?.observe(G),O.current=G)}},[C,V,_]),h.useEffect(()=>{const G=j.current!==o,B=Y.current!==L,re=X.current!==k;D.current&&(G||B||re)&&(G&&(j.current=o),B&&(Y.current=L),re&&(X.current=k),P.getState().updateNodeDimensions([{id:n,nodeElement:D.current,forceUpdate:!0}]))},[n,o,L,k]);const fe=Gn({nodeRef:D,disabled:C||!x,noDragClassName:E,handleSelector:R,nodeId:n,isSelectable:b,selectNodesOnDrag:I});return C?null:N.createElement("div",{className:ue(["react-flow__node",`react-flow__node-${o}`,{[A]:x},y,{selected:u,selectable:b,parent:M,dragging:fe}]),ref:D,style:{zIndex:T,transform:`translate(${c}px,${l}px)`,pointerEvents:ee?"all":"none",visibility:V?"visible":"hidden",...m},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:J,onMouseMove:W,onMouseLeave:le,onContextMenu:ie,onClick:ce,onDoubleClick:de,onKeyDown:H?Q:void 0,tabIndex:H?0:void 0,role:H?"button":void 0,"aria-describedby":Z?void 0:`${zn}-${w}`,"aria-label":F},N.createElement(rs,{value:n},N.createElement(e,{id:n,data:s,type:o,xPos:i,yPos:r,selected:u,isConnectable:v,sourcePosition:L,targetPosition:k,dragging:fe,dragHandle:R,zIndex:T})))};return t.displayName="NodeWrapper",h.memo(t)};const Xs=e=>{const t=e.getNodes().filter(n=>n.selected);return{...kt(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Ws({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=ne(),{width:s,height:i,x:r,y:c,transformString:l,userSelectionActive:u}=q(Xs,se),a=Kn(),d=h.useRef(null);if(h.useEffect(()=>{n||d.current?.focus({preventScroll:!0})},[n]),Gn({nodeRef:d}),u||!s||!i)return null;const p=e?S=>{const g=o.getState().getNodes().filter(m=>m.selected);e(S,g)}:void 0,f=S=>{Object.prototype.hasOwnProperty.call(Ye,S.key)&&a({x:Ye[S.key].x,y:Ye[S.key].y,isShiftPressed:S.shiftKey})};return N.createElement("div",{className:ue(["react-flow__nodesselection","react-flow__container",t]),style:{transform:l}},N.createElement("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:s,height:i,top:c,left:r}}))}var Gs=h.memo(Ws);const Ks=e=>e.nodesSelectionActive,jn=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,deleteKeyCode:c,onMove:l,onMoveStart:u,onMoveEnd:a,selectionKeyCode:d,selectionOnDrag:p,selectionMode:f,onSelectionStart:S,onSelectionEnd:g,multiSelectionKeyCode:m,panActivationKeyCode:y,zoomActivationKeyCode:x,elementsSelectable:b,zoomOnScroll:v,zoomOnPinch:H,panOnScroll:I,panOnScrollSpeed:L,panOnScrollMode:k,zoomOnDoubleClick:C,panOnDrag:$,defaultViewport:R,translateExtent:T,minZoom:M,maxZoom:E,preventScrolling:A,onSelectionContextMenu:V,noWheelClassName:Z,noPanClassName:F,disableKeyboardA11y:w})=>{const _=q(Ks),P=Je(d),D=Je(y),O=D||$,Y=D||I,X=P||p&&O!==!0;return Ds({deleteKeyCode:c,multiSelectionKeyCode:m}),N.createElement(Bs,{onMove:l,onMoveStart:u,onMoveEnd:a,onPaneContextMenu:i,elementsSelectable:b,zoomOnScroll:v,zoomOnPinch:H,panOnScroll:Y,panOnScrollSpeed:L,panOnScrollMode:k,zoomOnDoubleClick:C,panOnDrag:!P&&O,defaultViewport:R,translateExtent:T,minZoom:M,maxZoom:E,zoomActivationKeyCode:x,preventScrolling:A,noWheelClassName:Z,noPanClassName:F},N.createElement(Un,{onSelectionStart:S,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,panOnDrag:O,isSelecting:!!X,selectionMode:f},e,_&&N.createElement(Gs,{onSelectionContextMenu:V,noPanClassName:F,disableKeyboardA11y:w})))};jn.displayName="FlowRenderer";var js=h.memo(jn);function qs(e){return q(h.useCallback(n=>e?Cn(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function Qs(e){const t={input:qe(e.input||Pn),default:qe(e.default||vt),output:qe(e.output||kn),group:qe(e.group||zt)},n={},o=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,i)=>(s[i]=qe(e[i]||vt),s),n);return{...t,...o}}const Js=({x:e,y:t,width:n,height:o,origin:s})=>!n||!o?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-n*s[0],y:t-o*s[1]},er=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),qn=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,updateNodeDimensions:i,onError:r}=q(er,se),c=qs(e.onlyRenderVisibleElements),l=h.useRef(),u=h.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const a=new ResizeObserver(d=>{const p=d.map(f=>({id:f.target.getAttribute("data-id"),nodeElement:f.target,forceUpdate:!0}));i(p)});return l.current=a,a},[]);return h.useEffect(()=>()=>{l?.current?.disconnect()},[]),N.createElement("div",{className:"react-flow__nodes",style:Bt},c.map(a=>{let d=a.type||"default";e.nodeTypes[d]||(r?.("003",me.error003(d)),d="default");const p=e.nodeTypes[d]||e.nodeTypes.default,f=!!(a.draggable||t&&typeof a.draggable>"u"),S=!!(a.selectable||s&&typeof a.selectable>"u"),g=!!(a.connectable||n&&typeof a.connectable>"u"),m=!!(a.focusable||o&&typeof a.focusable>"u"),y=e.nodeExtent?It(a.positionAbsolute,e.nodeExtent):a.positionAbsolute,x=y?.x??0,b=y?.y??0,v=Js({x,y:b,width:a.width??0,height:a.height??0,origin:e.nodeOrigin});return N.createElement(p,{key:a.id,id:a.id,className:a.className,style:a.style,type:d,data:a.data,sourcePosition:a.sourcePosition||z.Bottom,targetPosition:a.targetPosition||z.Top,hidden:a.hidden,xPos:x,yPos:b,xPosOrigin:v.x,yPosOrigin:v.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!a.selected,isDraggable:f,isSelectable:S,isConnectable:g,isFocusable:m,resizeObserver:u,dragHandle:a.dragHandle,zIndex:a[K]?.z??0,isParent:!!a[K]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!a.width&&!!a.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:a.ariaLabel,hasHandleBounds:!!a[K]?.handleBounds})}))};qn.displayName="NodeRenderer";var tr=h.memo(qn);const nr=(e,t,n)=>n===z.Left?e-t:n===z.Right?e+t:e,or=(e,t,n)=>n===z.Top?e-t:n===z.Bottom?e+t:e,rn="react-flow__edgeupdater",cn=({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:i,onMouseOut:r,type:c})=>N.createElement("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:r,className:ue([rn,`${rn}-${c}`]),cx:nr(t,o,e),cy:or(n,o,e),r:o,stroke:"transparent",fill:"transparent"}),sr=()=>!0;var Le=e=>{const t=({id:n,className:o,type:s,data:i,onClick:r,onEdgeDoubleClick:c,selected:l,animated:u,label:a,labelStyle:d,labelShowBg:p,labelBgStyle:f,labelBgPadding:S,labelBgBorderRadius:g,style:m,source:y,target:x,sourceX:b,sourceY:v,targetX:H,targetY:I,sourcePosition:L,targetPosition:k,elementsSelectable:C,hidden:$,sourceHandleId:R,targetHandleId:T,onContextMenu:M,onMouseEnter:E,onMouseMove:A,onMouseLeave:V,reconnectRadius:Z,onReconnect:F,onReconnectStart:w,onReconnectEnd:_,markerEnd:P,markerStart:D,rfId:O,ariaLabel:Y,isFocusable:X,isReconnectable:j,pathOptions:ee,interactionWidth:te,disableKeyboardA11y:J})=>{const W=h.useRef(null),[le,ie]=h.useState(!1),[de,ce]=h.useState(!1),Q=ne(),fe=h.useMemo(()=>`url('#${bt(D,O)}')`,[D,O]),G=h.useMemo(()=>`url('#${bt(P,O)}')`,[P,O]);if($)return null;const B=oe=>{const{edges:ge,addSelectedEdges:Ce,unselectNodesAndEdges:ve,multiSelectionActive:_e}=Q.getState(),pe=ge.find(Me=>Me.id===n);pe&&(C&&(Q.setState({nodesSelectionActive:!1}),pe.selected&&_e?(ve({nodes:[],edges:[pe]}),W.current?.blur()):Ce([n])),r&&r(oe,pe))},re=Ke(n,Q.getState,c),we=Ke(n,Q.getState,M),Xe=Ke(n,Q.getState,E),Te=Ke(n,Q.getState,A),He=Ke(n,Q.getState,V),he=(oe,ge)=>{if(oe.button!==0)return;const{edges:Ce,isValidConnection:ve}=Q.getState(),_e=ge?x:y,pe=(ge?T:R)||null,Me=ge?"target":"source",ut=ve||sr,ft=ge,Ge=Ce.find(Ae=>Ae.id===n);ce(!0),w?.(oe,Ge,Me);const gt=Ae=>{ce(!1),_?.(Ae,Ge,Me)};In({event:oe,handleId:pe,nodeId:_e,onConnect:Ae=>F?.(Ge,Ae),isTarget:ft,getState:Q.getState,setState:Q.setState,isValidConnection:ut,edgeUpdaterType:Me,onReconnectEnd:gt})},Pe=oe=>he(oe,!0),Ne=oe=>he(oe,!1),be=()=>ie(!0),De=()=>ie(!1),ke=!C&&!r,We=oe=>{if(!J&&yn.includes(oe.key)&&C){const{unselectNodesAndEdges:ge,addSelectedEdges:Ce,edges:ve}=Q.getState();oe.key==="Escape"?(W.current?.blur(),ge({edges:[ve.find(pe=>pe.id===n)]})):Ce([n])}};return N.createElement("g",{className:ue(["react-flow__edge",`react-flow__edge-${s}`,o,{selected:l,animated:u,inactive:ke,updating:le}]),onClick:B,onDoubleClick:re,onContextMenu:we,onMouseEnter:Xe,onMouseMove:Te,onMouseLeave:He,onKeyDown:X?We:void 0,tabIndex:X?0:void 0,role:X?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":Y===null?void 0:Y||`Edge from ${y} to ${x}`,"aria-describedby":X?`${Bn}-${O}`:void 0,ref:W},!de&&N.createElement(e,{id:n,source:y,target:x,selected:l,animated:u,label:a,labelStyle:d,labelShowBg:p,labelBgStyle:f,labelBgPadding:S,labelBgBorderRadius:g,data:i,style:m,sourceX:b,sourceY:v,targetX:H,targetY:I,sourcePosition:L,targetPosition:k,sourceHandleId:R,targetHandleId:T,markerStart:fe,markerEnd:G,pathOptions:ee,interactionWidth:te}),j&&N.createElement(N.Fragment,null,(j==="source"||j===!0)&&N.createElement(cn,{position:L,centerX:b,centerY:v,radius:Z,onMouseDown:Pe,onMouseEnter:be,onMouseOut:De,type:"source"}),(j==="target"||j===!0)&&N.createElement(cn,{position:k,centerX:H,centerY:I,radius:Z,onMouseDown:Ne,onMouseEnter:be,onMouseOut:De,type:"target"})))};return t.displayName="EdgeWrapper",h.memo(t)};function rr(e){const t={default:Le(e.default||ct),straight:Le(e.bezier||Pt),step:Le(e.step||Ht),smoothstep:Le(e.step||dt),simplebezier:Le(e.simplebezier||Tt)},n={},o=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,i)=>(s[i]=Le(e[i]||ct),s),n);return{...t,...o}}function an(e,t,n=null){const o=(n?.x||0)+t.x,s=(n?.y||0)+t.y,i=n?.width||t.width,r=n?.height||t.height;switch(e){case z.Top:return{x:o+i/2,y:s};case z.Right:return{x:o+i,y:s+r/2};case z.Bottom:return{x:o+i/2,y:s+r};case z.Left:return{x:o,y:s+r/2}}}function ln(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const ir=(e,t,n,o,s,i)=>{const r=an(n,e,t),c=an(i,o,s);return{sourceX:r.x,sourceY:r.y,targetX:c.x,targetY:c.y}};function cr({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:o,targetWidth:s,targetHeight:i,width:r,height:c,transform:l}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+o,t.y+i)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const a=Rt({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:r/l[2],height:c/l[2]}),d=Math.max(0,Math.min(a.x2,u.x2)-Math.max(a.x,u.x)),p=Math.max(0,Math.min(a.y2,u.y2)-Math.max(a.y,u.y));return Math.ceil(d*p)>0}function dn(e){const t=e?.[K]?.handleBounds||null,n=t&&e?.width&&e?.height&&typeof e?.positionAbsolute?.x<"u"&&typeof e?.positionAbsolute?.y<"u";return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},t,!!n]}const ar=[{level:0,isMaxLevel:!0,edges:[]}];function lr(e,t,n=!1){let o=-1;const s=e.reduce((r,c)=>{const l=ae(c.zIndex);let u=l?c.zIndex:0;if(n){const a=t.get(c.target),d=t.get(c.source),p=c.selected||a?.selected||d?.selected,f=Math.max(d?.[K]?.z||0,a?.[K]?.z||0,1e3);u=(l?c.zIndex:0)+(p?f:0)}return r[u]?r[u].push(c):r[u]=[c],o=u>o?u:o,r},{}),i=Object.entries(s).map(([r,c])=>{const l=+r;return{edges:c,level:l,isMaxLevel:l===o}});return i.length===0?ar:i}function dr(e,t,n){const o=q(h.useCallback(s=>e?s.edges.filter(i=>{const r=t.get(i.source),c=t.get(i.target);return r?.width&&r?.height&&c?.width&&c?.height&&cr({sourcePos:r.positionAbsolute||{x:0,y:0},targetPos:c.positionAbsolute||{x:0,y:0},sourceWidth:r.width,sourceHeight:r.height,targetWidth:c.width,targetHeight:c.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return lr(o,t,n)}const ur=({color:e="none",strokeWidth:t=1})=>N.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),fr=({color:e="none",strokeWidth:t=1})=>N.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),un={[it.Arrow]:ur,[it.ArrowClosed]:fr};function gr(e){const t=ne();return h.useMemo(()=>Object.prototype.hasOwnProperty.call(un,e)?un[e]:(t.getState().onError?.("009",me.error009(e)),null),[e])}const pr=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:r,orient:c="auto-start-reverse"})=>{const l=gr(t);return l?N.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:c,refX:"0",refY:"0"},N.createElement(l,{color:n,strokeWidth:r})):null},hr=({defaultColor:e,rfId:t})=>n=>{const o=[];return n.edges.reduce((s,i)=>([i.markerStart,i.markerEnd].forEach(r=>{if(r&&typeof r=="object"){const c=bt(r,t);o.includes(c)||(s.push({id:c,color:r.color||e,...r}),o.push(c))}}),s),[]).sort((s,i)=>s.id.localeCompare(i.id))},Qn=({defaultColor:e,rfId:t})=>{const n=q(h.useCallback(hr({defaultColor:e,rfId:t}),[e,t]),(o,s)=>!(o.length!==s.length||o.some((i,r)=>i.id!==s[r].id)));return N.createElement("defs",null,n.map(o=>N.createElement(pr,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};Qn.displayName="MarkerDefinitions";var mr=h.memo(Qn);const yr=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Jn=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:o,edgeTypes:s,noPanClassName:i,onEdgeContextMenu:r,onEdgeMouseEnter:c,onEdgeMouseMove:l,onEdgeMouseLeave:u,onEdgeClick:a,onEdgeDoubleClick:d,onReconnect:p,onReconnectStart:f,onReconnectEnd:S,reconnectRadius:g,children:m,disableKeyboardA11y:y})=>{const{edgesFocusable:x,edgesUpdatable:b,elementsSelectable:v,width:H,height:I,connectionMode:L,nodeInternals:k,onError:C}=q(yr,se),$=dr(t,k,n);return H?N.createElement(N.Fragment,null,$.map(({level:R,edges:T,isMaxLevel:M})=>N.createElement("svg",{key:R,style:{zIndex:R},width:H,height:I,className:"react-flow__edges react-flow__container"},M&&N.createElement(mr,{defaultColor:e,rfId:o}),N.createElement("g",null,T.map(E=>{const[A,V,Z]=dn(k.get(E.source)),[F,w,_]=dn(k.get(E.target));if(!Z||!_)return null;let P=E.type||"default";s[P]||(C?.("011",me.error011(P)),P="default");const D=s[P]||s.default,O=L===Re.Strict?w.target:(w.target??[]).concat(w.source??[]),Y=ln(V.source,E.sourceHandle),X=ln(O,E.targetHandle),j=Y?.position||z.Bottom,ee=X?.position||z.Top,te=!!(E.focusable||x&&typeof E.focusable>"u"),J=E.reconnectable||E.updatable,W=typeof p<"u"&&(J||b&&typeof J>"u");if(!Y||!X)return C?.("008",me.error008(Y,E)),null;const{sourceX:le,sourceY:ie,targetX:de,targetY:ce}=ir(A,Y,j,F,X,ee);return N.createElement(D,{key:E.id,id:E.id,className:ue([E.className,i]),type:P,data:E.data,selected:!!E.selected,animated:!!E.animated,hidden:!!E.hidden,label:E.label,labelStyle:E.labelStyle,labelShowBg:E.labelShowBg,labelBgStyle:E.labelBgStyle,labelBgPadding:E.labelBgPadding,labelBgBorderRadius:E.labelBgBorderRadius,style:E.style,source:E.source,target:E.target,sourceHandleId:E.sourceHandle,targetHandleId:E.targetHandle,markerEnd:E.markerEnd,markerStart:E.markerStart,sourceX:le,sourceY:ie,targetX:de,targetY:ce,sourcePosition:j,targetPosition:ee,elementsSelectable:v,onContextMenu:r,onMouseEnter:c,onMouseMove:l,onMouseLeave:u,onClick:a,onEdgeDoubleClick:d,onReconnect:p,onReconnectStart:f,onReconnectEnd:S,reconnectRadius:g,rfId:o,ariaLabel:E.ariaLabel,isFocusable:te,isReconnectable:W,pathOptions:"pathOptions"in E?E.pathOptions:void 0,interactionWidth:E.interactionWidth,disableKeyboardA11y:y})})))),m):null};Jn.displayName="EdgeRenderer";var xr=h.memo(Jn);const Er=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Sr({children:e}){const t=q(Er);return N.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function wr(e){const t=Fn(),n=h.useRef(!1);h.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Nr={[z.Left]:z.Right,[z.Right]:z.Left,[z.Top]:z.Bottom,[z.Bottom]:z.Top},eo=({nodeId:e,handleType:t,style:n,type:o=Ee.Bezier,CustomComponent:s,connectionStatus:i})=>{const{fromNode:r,handleId:c,toX:l,toY:u,connectionMode:a}=q(h.useCallback(I=>({fromNode:I.nodeInternals.get(e),handleId:I.connectionHandleId,toX:(I.connectionPosition.x-I.transform[0])/I.transform[2],toY:(I.connectionPosition.y-I.transform[1])/I.transform[2],connectionMode:I.connectionMode}),[e]),se),d=r?.[K]?.handleBounds;let p=d?.[t];if(a===Re.Loose&&(p=p||d?.[t==="source"?"target":"source"]),!r||!p)return null;const f=c?p.find(I=>I.id===c):p[0],S=f?f.x+f.width/2:(r.width??0)/2,g=f?f.y+f.height/2:r.height??0,m=(r.positionAbsolute?.x??0)+S,y=(r.positionAbsolute?.y??0)+g,x=f?.position,b=x?Nr[x]:null;if(!x||!b)return null;if(s)return N.createElement(s,{connectionLineType:o,connectionLineStyle:n,fromNode:r,fromHandle:f,fromX:m,fromY:y,toX:l,toY:u,fromPosition:x,toPosition:b,connectionStatus:i});let v="";const H={sourceX:m,sourceY:y,sourcePosition:x,targetX:l,targetY:u,targetPosition:b};return o===Ee.Bezier?[v]=Nn(H):o===Ee.Step?[v]=Nt({...H,borderRadius:0}):o===Ee.SmoothStep?[v]=Nt(H):o===Ee.SimpleBezier?[v]=wn(H):v=`M${m},${y} ${l},${u}`,N.createElement("path",{d:v,fill:"none",className:"react-flow__connection-path",style:n})};eo.displayName="ConnectionLine";const br=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function Cr({containerStyle:e,style:t,type:n,component:o}){const{nodeId:s,handleType:i,nodesConnectable:r,width:c,height:l,connectionStatus:u}=q(br,se);return!(s&&i&&c&&r)?null:N.createElement("svg",{style:e,width:c,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container"},N.createElement("g",{className:ue(["react-flow__connection",u])},N.createElement(eo,{nodeId:s,handleType:i,style:t,type:n,CustomComponent:o,connectionStatus:u})))}function fn(e,t){return h.useRef(null),ne(),h.useMemo(()=>t(e),[e])}const to=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:o,onMoveEnd:s,onInit:i,onNodeClick:r,onEdgeClick:c,onNodeDoubleClick:l,onEdgeDoubleClick:u,onNodeMouseEnter:a,onNodeMouseMove:d,onNodeMouseLeave:p,onNodeContextMenu:f,onSelectionContextMenu:S,onSelectionStart:g,onSelectionEnd:m,connectionLineType:y,connectionLineStyle:x,connectionLineComponent:b,connectionLineContainerStyle:v,selectionKeyCode:H,selectionOnDrag:I,selectionMode:L,multiSelectionKeyCode:k,panActivationKeyCode:C,zoomActivationKeyCode:$,deleteKeyCode:R,onlyRenderVisibleElements:T,elementsSelectable:M,selectNodesOnDrag:E,defaultViewport:A,translateExtent:V,minZoom:Z,maxZoom:F,preventScrolling:w,defaultMarkerColor:_,zoomOnScroll:P,zoomOnPinch:D,panOnScroll:O,panOnScrollSpeed:Y,panOnScrollMode:X,zoomOnDoubleClick:j,panOnDrag:ee,onPaneClick:te,onPaneMouseEnter:J,onPaneMouseMove:W,onPaneMouseLeave:le,onPaneScroll:ie,onPaneContextMenu:de,onEdgeContextMenu:ce,onEdgeMouseEnter:Q,onEdgeMouseMove:fe,onEdgeMouseLeave:G,onReconnect:B,onReconnectStart:re,onReconnectEnd:we,reconnectRadius:Xe,noDragClassName:Te,noWheelClassName:He,noPanClassName:he,elevateEdgesOnSelect:Pe,disableKeyboardA11y:Ne,nodeOrigin:be,nodeExtent:De,rfId:ke})=>{const We=fn(e,Qs),oe=fn(t,rr);return wr(i),N.createElement(js,{onPaneClick:te,onPaneMouseEnter:J,onPaneMouseMove:W,onPaneMouseLeave:le,onPaneContextMenu:de,onPaneScroll:ie,deleteKeyCode:R,selectionKeyCode:H,selectionOnDrag:I,selectionMode:L,onSelectionStart:g,onSelectionEnd:m,multiSelectionKeyCode:k,panActivationKeyCode:C,zoomActivationKeyCode:$,elementsSelectable:M,onMove:n,onMoveStart:o,onMoveEnd:s,zoomOnScroll:P,zoomOnPinch:D,zoomOnDoubleClick:j,panOnScroll:O,panOnScrollSpeed:Y,panOnScrollMode:X,panOnDrag:ee,defaultViewport:A,translateExtent:V,minZoom:Z,maxZoom:F,onSelectionContextMenu:S,preventScrolling:w,noDragClassName:Te,noWheelClassName:He,noPanClassName:he,disableKeyboardA11y:Ne},N.createElement(Sr,null,N.createElement(xr,{edgeTypes:oe,onEdgeClick:c,onEdgeDoubleClick:u,onlyRenderVisibleElements:T,onEdgeContextMenu:ce,onEdgeMouseEnter:Q,onEdgeMouseMove:fe,onEdgeMouseLeave:G,onReconnect:B,onReconnectStart:re,onReconnectEnd:we,reconnectRadius:Xe,defaultMarkerColor:_,noPanClassName:he,elevateEdgesOnSelect:!!Pe,disableKeyboardA11y:Ne,rfId:ke},N.createElement(Cr,{style:x,type:y,component:b,containerStyle:v})),N.createElement("div",{className:"react-flow__edgelabel-renderer"}),N.createElement(tr,{nodeTypes:We,onNodeClick:r,onNodeDoubleClick:l,onNodeMouseEnter:a,onNodeMouseMove:d,onNodeMouseLeave:p,onNodeContextMenu:f,selectNodesOnDrag:E,onlyRenderVisibleElements:T,noPanClassName:he,noDragClassName:Te,disableKeyboardA11y:Ne,nodeOrigin:be,nodeExtent:De,rfId:ke})))};to.displayName="GraphView";var vr=h.memo(to);const At=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],ye={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:At,nodeExtent:At,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Re.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Jo,isValidConnection:void 0},Mr=()=>Lo((e,t)=>({...ye,setNodes:n=>{const{nodeInternals:o,nodeOrigin:s,elevateNodesOnSelect:i}=t();e({nodeInternals:mt(n,o,s,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:o={}}=t();e({edges:n.map(s=>({...o,...s}))})},setDefaultNodesAndEdges:(n,o)=>{const s=typeof n<"u",i=typeof o<"u",r=s?mt(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:r,edges:i?o:[],hasDefaultNodes:s,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:o,nodeInternals:s,fitViewOnInit:i,fitViewOnInitDone:r,fitViewOnInitOptions:c,domNode:l,nodeOrigin:u}=t(),a=l?.querySelector(".react-flow__viewport");if(!a)return;const d=window.getComputedStyle(a),{m22:p}=new window.DOMMatrixReadOnly(d.transform),f=n.reduce((g,m)=>{const y=s.get(m.id);if(y?.hidden)s.set(y.id,{...y,[K]:{...y[K],handleBounds:void 0}});else if(y){const x=$t(m.nodeElement);!!(x.width&&x.height&&(y.width!==x.width||y.height!==x.height||m.forceUpdate))&&(s.set(y.id,{...y,[K]:{...y[K],handleBounds:{source:sn(".source",m.nodeElement,p,u),target:sn(".target",m.nodeElement,p,u)}},...x}),g.push({id:y.id,type:"dimensions",dimensions:x}))}return g},[]);Ln(s,u);const S=r||i&&!r&&On(t,{initial:!0,...c});e({nodeInternals:new Map(s),fitViewOnInitDone:S}),f?.length>0&&o?.(f)},updateNodePositions:(n,o=!0,s=!1)=>{const{triggerNodeChanges:i}=t(),r=n.map(c=>{const l={id:c.id,type:"position",dragging:s};return o&&(l.positionAbsolute=c.positionAbsolute,l.position=c.position),l});i(r)},triggerNodeChanges:n=>{const{onNodesChange:o,nodeInternals:s,hasDefaultNodes:i,nodeOrigin:r,getNodes:c,elevateNodesOnSelect:l}=t();if(n?.length){if(i){const u=Yn(n,c()),a=mt(u,s,r,l);e({nodeInternals:a})}o?.(n)}},addSelectedNodes:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,c=null;o?r=n.map(l=>xe(l,!0)):(r=Oe(i(),n),c=Oe(s,[])),ot({changedNodes:r,changedEdges:c,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,c=null;o?r=n.map(l=>xe(l,!0)):(r=Oe(s,n),c=Oe(i(),[])),ot({changedNodes:c,changedEdges:r,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:o}={})=>{const{edges:s,getNodes:i}=t(),r=n||i(),c=o||s,l=r.map(a=>(a.selected=!1,xe(a.id,!1))),u=c.map(a=>xe(a.id,!1));ot({changedNodes:l,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:o,maxZoom:s}=t();o?.scaleExtent([n,s]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:o,minZoom:s}=t();o?.scaleExtent([s,n]),e({maxZoom:n})},setTranslateExtent:n=>{t().d3Zoom?.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:o}=t(),i=o().filter(c=>c.selected).map(c=>xe(c.id,!1)),r=n.filter(c=>c.selected).map(c=>xe(c.id,!1));ot({changedNodes:i,changedEdges:r,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:o}=t();o.forEach(s=>{s.positionAbsolute=It(s.position,n)}),e({nodeExtent:n,nodeInternals:new Map(o)})},panBy:n=>{const{transform:o,width:s,height:i,d3Zoom:r,d3Selection:c,translateExtent:l}=t();if(!r||!c||!n.x&&!n.y)return!1;const u=Fe.translate(o[0]+n.x,o[1]+n.y).scale(o[2]),a=[[0,0],[s,i]],d=r?.constrain()(u,a,l);return r.transform(c,d),o[0]!==d.x||o[1]!==d.y||o[2]!==d.k},cancelConnection:()=>e({connectionNodeId:ye.connectionNodeId,connectionHandleId:ye.connectionHandleId,connectionHandleType:ye.connectionHandleType,connectionStatus:ye.connectionStatus,connectionStartHandle:ye.connectionStartHandle,connectionEndHandle:ye.connectionEndHandle}),reset:()=>e({...ye})}),Object.is),no=({children:e})=>{const t=h.useRef(null);return t.current||(t.current=Mr()),N.createElement(Yo,{value:t.current},e)};no.displayName="ReactFlowProvider";const oo=({children:e})=>h.useContext(lt)?N.createElement(N.Fragment,null,e):N.createElement(no,null,e);oo.displayName="ReactFlowWrapper";const Ar={input:Pn,default:vt,output:kn,group:zt},$r={default:ct,straight:Pt,step:Ht,smoothstep:dt,simplebezier:Tt},Ir=[0,0],Rr=[15,15],Tr={x:0,y:0,zoom:1},Hr={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Pr=h.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:i=Ar,edgeTypes:r=$r,onNodeClick:c,onEdgeClick:l,onInit:u,onMove:a,onMoveStart:d,onMoveEnd:p,onConnect:f,onConnectStart:S,onConnectEnd:g,onClickConnectStart:m,onClickConnectEnd:y,onNodeMouseEnter:x,onNodeMouseMove:b,onNodeMouseLeave:v,onNodeContextMenu:H,onNodeDoubleClick:I,onNodeDragStart:L,onNodeDrag:k,onNodeDragStop:C,onNodesDelete:$,onEdgesDelete:R,onSelectionChange:T,onSelectionDragStart:M,onSelectionDrag:E,onSelectionDragStop:A,onSelectionContextMenu:V,onSelectionStart:Z,onSelectionEnd:F,connectionMode:w=Re.Strict,connectionLineType:_=Ee.Bezier,connectionLineStyle:P,connectionLineComponent:D,connectionLineContainerStyle:O,deleteKeyCode:Y="Backspace",selectionKeyCode:X="Shift",selectionOnDrag:j=!1,selectionMode:ee=Qe.Full,panActivationKeyCode:te="Space",multiSelectionKeyCode:J=rt()?"Meta":"Control",zoomActivationKeyCode:W=rt()?"Meta":"Control",snapToGrid:le=!1,snapGrid:ie=Rr,onlyRenderVisibleElements:de=!1,selectNodesOnDrag:ce=!0,nodesDraggable:Q,nodesConnectable:fe,nodesFocusable:G,nodeOrigin:B=Ir,edgesFocusable:re,edgesUpdatable:we,elementsSelectable:Xe,defaultViewport:Te=Tr,minZoom:He=.5,maxZoom:he=2,translateExtent:Pe=At,preventScrolling:Ne=!0,nodeExtent:be,defaultMarkerColor:De="#b1b1b7",zoomOnScroll:ke=!0,zoomOnPinch:We=!0,panOnScroll:oe=!1,panOnScrollSpeed:ge=.5,panOnScrollMode:Ce=Ie.Free,zoomOnDoubleClick:ve=!0,panOnDrag:_e=!0,onPaneClick:pe,onPaneMouseEnter:Me,onPaneMouseMove:ut,onPaneMouseLeave:ft,onPaneScroll:Ge,onPaneContextMenu:gt,children:Vt,onEdgeContextMenu:Ae,onEdgeDoubleClick:ro,onEdgeMouseEnter:io,onEdgeMouseMove:co,onEdgeMouseLeave:ao,onEdgeUpdate:lo,onEdgeUpdateStart:uo,onEdgeUpdateEnd:fo,onReconnect:go,onReconnectStart:po,onReconnectEnd:ho,reconnectRadius:mo=10,edgeUpdaterRadius:yo=10,onNodesChange:xo,onEdgesChange:Eo,noDragClassName:So="nodrag",noWheelClassName:wo="nowheel",noPanClassName:Lt="nopan",fitView:No=!1,fitViewOptions:bo,connectOnClick:Co=!0,attributionPosition:vo,proOptions:Mo,defaultEdgeOptions:Ao,elevateNodesOnSelect:$o=!0,elevateEdgesOnSelect:Io=!1,disableKeyboardA11y:Ot=!1,autoPanOnConnect:Ro=!0,autoPanOnNodeDrag:To=!0,connectionRadius:Ho=20,isValidConnection:Po,onError:Do,style:ko,id:Ft,nodeDragThreshold:_o,...zo},Bo)=>{const pt=Ft||"1";return N.createElement("div",{...zo,style:{...ko,...Hr},ref:Bo,className:ue(["react-flow",s]),"data-testid":"rf__wrapper",id:Ft},N.createElement(oo,null,N.createElement(vr,{onInit:u,onMove:a,onMoveStart:d,onMoveEnd:p,onNodeClick:c,onEdgeClick:l,onNodeMouseEnter:x,onNodeMouseMove:b,onNodeMouseLeave:v,onNodeContextMenu:H,onNodeDoubleClick:I,nodeTypes:i,edgeTypes:r,connectionLineType:_,connectionLineStyle:P,connectionLineComponent:D,connectionLineContainerStyle:O,selectionKeyCode:X,selectionOnDrag:j,selectionMode:ee,deleteKeyCode:Y,multiSelectionKeyCode:J,panActivationKeyCode:te,zoomActivationKeyCode:W,onlyRenderVisibleElements:de,selectNodesOnDrag:ce,defaultViewport:Te,translateExtent:Pe,minZoom:He,maxZoom:he,preventScrolling:Ne,zoomOnScroll:ke,zoomOnPinch:We,zoomOnDoubleClick:ve,panOnScroll:oe,panOnScrollSpeed:ge,panOnScrollMode:Ce,panOnDrag:_e,onPaneClick:pe,onPaneMouseEnter:Me,onPaneMouseMove:ut,onPaneMouseLeave:ft,onPaneScroll:Ge,onPaneContextMenu:gt,onSelectionContextMenu:V,onSelectionStart:Z,onSelectionEnd:F,onEdgeContextMenu:Ae,onEdgeDoubleClick:ro,onEdgeMouseEnter:io,onEdgeMouseMove:co,onEdgeMouseLeave:ao,onReconnect:go??lo,onReconnectStart:po??uo,onReconnectEnd:ho??fo,reconnectRadius:mo??yo,defaultMarkerColor:De,noDragClassName:So,noWheelClassName:wo,noPanClassName:Lt,elevateEdgesOnSelect:Io,rfId:pt,disableKeyboardA11y:Ot,nodeOrigin:B,nodeExtent:be}),N.createElement(Ns,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:f,onConnectStart:S,onConnectEnd:g,onClickConnectStart:m,onClickConnectEnd:y,nodesDraggable:Q,nodesConnectable:fe,nodesFocusable:G,edgesFocusable:re,edgesUpdatable:we,elementsSelectable:Xe,elevateNodesOnSelect:$o,minZoom:He,maxZoom:he,nodeExtent:be,onNodesChange:xo,onEdgesChange:Eo,snapToGrid:le,snapGrid:ie,connectionMode:w,translateExtent:Pe,connectOnClick:Co,defaultEdgeOptions:Ao,fitView:No,fitViewOptions:bo,onNodesDelete:$,onEdgesDelete:R,onNodeDragStart:L,onNodeDrag:k,onNodeDragStop:C,onSelectionDrag:E,onSelectionDragStart:M,onSelectionDragStop:A,noPanClassName:Lt,nodeOrigin:B,rfId:pt,autoPanOnConnect:Ro,autoPanOnNodeDrag:To,onError:Do,connectionRadius:Ho,isValidConnection:Po,nodeDragThreshold:_o}),N.createElement(Ss,{onSelectionChange:T}),Vt,N.createElement(Wo,{proOptions:Mo,position:vo}),N.createElement(As,{rfId:pt,disableKeyboardA11y:Ot})))});Pr.displayName="ReactFlow";function so(e){return t=>{const[n,o]=h.useState(t),s=h.useCallback(i=>o(r=>e(i,r)),[]);return[n,o,s]}}const Or=so(Yn),Fr=so(Os);export{it as M,Xo as P,Pr as R,ne as a,Fn as b,Or as c,Fr as d,q as u};
